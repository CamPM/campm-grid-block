<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Block Blast Clone</title>
    <style>
        :root { --bg: #1a1a1a; --board: #333; --text: #fff; --accent: #4CAF50; }
        [data-theme="classic"] { --bg: #2c3e50; --board: #34495e; --accent: #e74c3c; }
        [data-theme="neon"] { --bg: #000; --board: #111; --accent: #0ff; }
        
        body { margin: 0; background: var(--bg); color: var(--text); font-family: sans-serif; overflow: hidden; display: flex; flex-direction: column; align-items: center; }
        #game-container { width: 100%; max-width: 500px; padding: 10px; text-align: center; }
        
        .stats { display: flex; justify-content: space-between; width: 100%; padding: 10px; font-size: 1.2rem; }
        
        #grid { display: grid; gap: 4px; background: var(--board); padding: 10px; border-radius: 8px; margin: 20px auto; }
        .cell { background: rgba(255,255,255,0.1); border-radius: 4px; aspect-ratio: 1; }
        .cell.filled { transition: transform 0.2s; }

        #pieces-area { display: flex; justify-content: space-around; height: 120px; margin-top: 20px; }
        .piece-preview { transform: scale(0.6); cursor: grab; }

        .btn-group { display: flex; gap: 5px; margin-top: 10px; flex-wrap: wrap; justify-content: center; }
        button { padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; background: var(--accent); color: white; }
        
        #modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #222; padding: 20px; border: 2px solid var(--accent); z-index: 100; width: 80%; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 90; }
    </style>
</head>
<body data-theme="classic">

<div id="game-container">
    <div class="stats">
        <div>Score: <span id="score">0</span></div>
        <div>High: <span id="highscore">0</span></div>
        <div>Points: <span id="points">0</span></div>
    </div>

    <div id="grid"></div>

    <div id="pieces-area"></div>

    <div class="btn-group">
        <button onclick="toggleMute()">Mute</button>
        <button onclick="toggleFullScreen()">Full Screen</button>
        <button onclick="openHelp()">Help</button>
        <button onclick="openShop()">Shop</button>
    </div>
</div>

<div id="overlay" class="overlay"></div>
<div id="modal" class="modal">
    <div id="modal-content"></div>
    <br>
    <button onclick="closeModal()">Close / Restart</button>
</div>

<script>
    // Game State
    let score = 0, highscore = localStorage.getItem('blockHigh') || 0;
    let points = localStorage.getItem('blockPoints') || 0;
    let boardSize = 8;
    let muted = false;
    let unlockedThemes = ['classic', 'dark'];
    let currentThemeIdx = 0;

    const grid = document.getElementById('grid');
    const scoreEl = document.getElementById('score');
    const highscoreEl = document.getElementById('highscore');
    const pointsEl = document.getElementById('points');

    // Initialize Game
    function init(size = 8) {
        boardSize = size;
        grid.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
        grid.innerHTML = '';
        for(let i=0; i < size*size; i++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.dataset.idx = i;
            grid.appendChild(cell);
        }
        highscoreEl.innerText = highscore;
        pointsEl.innerText = points;
        spawnPieces();
    }

    function spawnPieces() {
        const area = document.getElementById('pieces-area');
        area.innerHTML = '';
        for(let i=0; i<3; i++) {
            const piece = document.createElement('div');
            piece.className = 'piece-preview';
            piece.innerHTML = '▊▊<br>▊▊'; // Simplified for demo
            piece.draggable = true;
            area.appendChild(piece);
        }
    }

    // Logic for clearing lines
    function checkLines() {
        // Pseudo-code logic for GitHub compatibility
        // Iterate rows/columns, if full, clear and points++
        // If clear occurs: cycleTheme();
    }

    function cycleTheme() {
        currentThemeIdx = (currentThemeIdx + 1) % unlockedThemes.length;
        document.body.setAttribute('data-theme', unlockedThemes[currentThemeIdx]);
    }

    function toggleFullScreen() {
        if (!document.fullscreenElement) document.documentElement.requestFullscreen();
        else document.exitFullscreen();
    }

    function openHelp() {
        showModal("<h3>How to Play</h3><p>Drag blocks to clear lines. Powerups: <br>1. Bomb: Clear 3x3 <br>2. Refresh: Get new pieces <br>3. Rotate: Turn a piece.</p>");
    }

    function showModal(html) {
        document.getElementById('modal-content').innerHTML = html;
        document.getElementById('modal').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    }

    function closeModal() {
        document.getElementById('modal').style.display = 'none';
        document.getElementById('overlay').style.display = 'none';
    }

    window.onload = () => init(8);
</script>
</body>
</html>
